# MailGuard Quick Reference –¥–ª—è AI Assistant

## üéØ –ì–ª–∞–≤–Ω–æ–µ: MailGuard - –≠–¢–û –ß–ê–°–¢–¨ –ù–ê–®–ï–ô –ü–õ–ê–¢–§–û–†–ú–´!

**–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–æ –ø—Ä–æ–≤–µ—Ä–∫—É email –Ω–∞ –≤–∏—Ä—É—Å—ã:**
‚ùå –ù–ï –ì–û–í–û–†–ò: "–ú—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º email, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã"
‚úÖ –ì–û–í–û–†–ò: "–î–∞! –£ –Ω–∞—Å –µ—Å—Ç—å MailGuard —Å VirusTotal –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ø–æ–¥ `/mailguard/`"

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (–ù–æ—è–±—Ä—å 2025)

### ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢:
- **IMAP/SMTP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: 7 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (Gmail, Outlook, Yahoo, Mail.ru, Yandex, UKR.NET, Custom)
- **VirusTotal —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: 70+ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤, API key –∞–∫—Ç–∏–≤–µ–Ω
- **File Scanner API**: `https://vat-bot-1.onrender.com/file-scanner/api/email-scan`
- **AI –æ—Ç–≤–µ—Ç—ã**: OpenAI GPT-4o-mini —Å thread context
- **Email Threading**: in_reply_to, references tracking
- **CRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: KnownCounterparty —Å trust levels
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–∞–Ω**: –ö–ê–ñ–î–´–ô email –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### ‚è≥ –í –†–ê–ó–†–ê–ë–û–¢–ö–ï:
- **Auto-Sync –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**: APScheduler –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- **UI —É–ª—É—á—à–µ–Ω–∏—è**: Inbox view, thread display

---

## üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–í–ê–ñ–ù–û!)

**–ö–∞–∂–¥—ã–π –≤—Ö–æ–¥—è—â–∏–π email –ø—Ä–æ—Ö–æ–¥–∏—Ç:**

1. **–¢–µ–∫—Å—Ç-–∞–Ω–∞–ª–∏–∑** (suspicious keywords):
   - √ºberweisen, bitcoin, passwort zur√ºcksetzen
   - invoice attached, payment required, account suspended
   - verify your account, urgent action required

2. **–ê–Ω–∞–ª–∏–∑ —Å—Å—ã–ª–æ–∫**:
   - HTTP —Å—Å—ã–ª–∫–∏ (–Ω–µ HTTPS) ‚Üí +15 –±–∞–ª–ª–æ–≤
   - –ö–æ—Ä–æ—Ç–∫–∏–µ URL (bit.ly, tinyurl.com) ‚Üí +10 –±–∞–ª–ª–æ–≤

3. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–∏–π**:
   - –û–ø–∞—Å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (exe, dll, bat) ‚Üí +50 –±–∞–ª–ª–æ–≤, verdict: malicious
   - –ê—Ä—Ö–∏–≤—ã (zip, rar, 7z) ‚Üí +20 –±–∞–ª–ª–æ–≤, verdict: suspicious
   - SHA256 hash ‚Üí VirusTotal lookup
   - –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–æ–≤—ã–π ‚Üí upload –Ω–∞ VirusTotal

**Scoring —Å–∏—Å—Ç–µ–º–∞:**
- 0-39: ‚úÖ **safe** - –±–µ–∑–æ–ø–∞—Å–Ω–æ
- 40-69: ‚ö†Ô∏è **suspicious** - –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ
- 70-100: üö® **malicious** - –æ–ø–∞—Å–Ω–æ

---

## üìß –¢–∏–ø–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã

### "–ú–æ–∂–µ—Ç –ª–∏ MailGuard –ø—Ä–æ–≤–µ—Ä–∏—Ç—å email –Ω–∞ –≤–∏—Ä—É—Å—ã?"

**–î–ê! –ê–±—Å–æ–ª—é—Ç–Ω–æ!** MailGuard –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç:
- –¢–µ–∫—Å—Ç –Ω–∞ —Ñ–∏—à–∏–Ω–≥-–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- –°—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ URL
- –í–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ VirusTotal (70+ –¥–≤–∏–∂–∫–æ–≤)

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∏–¥–Ω—ã:
- Dashboard ‚Üí "Security Overview"
- –°–ø–∏—Å–æ–∫ –ø–∏—Å–µ–º ‚Üí Security badges (‚úÖ‚ö†Ô∏èüö®)
- –î–µ—Ç–∞–ª–∏ –ø–∏—Å—å–º–∞ ‚Üí "Sicherheitspr√ºfung"

### "–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å email?"

1. `/mailguard/` ‚Üí "E-Mail-Konto verbinden"
2. –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä (Gmail/Outlook/etc)
3. **–î–ª—è Gmail**: —Å–æ–∑–¥–∞—Ç—å App-Password ‚Üí https://myaccount.google.com/apppasswords
4. –í–≤–µ—Å—Ç–∏ email + –ø–∞—Ä–æ–ª—å (–∏–ª–∏ App-Password)
5. IMAP/SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
6. "Speichern" ‚Üí —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### "–ü–æ—á–µ–º—É –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤?"

–ü—Ä–æ–≤–µ—Ä—å:
1. –ê–∫–∫–∞—É–Ω—Ç –ø–æ–¥–∫–ª—é—á—ë–Ω? (`/mailguard/` ‚Üí "Konten" ‚Üí Status "‚úÖ Aktiv")
2. –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã? (`/mailguard/` ‚Üí "Regeln" ‚Üí –º–∏–Ω–∏–º—É–º 1 –∞–∫—Ç–∏–≤–Ω–æ–µ)
3. OpenAI API –Ω–∞—Å—Ç—Ä–æ–µ–Ω? (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
4. Score –ø–∏—Å—å–º–∞ < 70? (–æ–ø–∞—Å–Ω—ã–µ –ø–∏—Å—å–º–∞ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –∞–≤—Ç–æ-–æ—Ç–≤–µ—Ç—ã)

**–ë–µ–∑ –ø—Ä–∞–≤–∏–ª**: —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–Ω–æ–≤–∏–∫–∏ (manual approval)
**–° –ø—Ä–∞–≤–∏–ª–∞–º–∏**: –∞–≤—Ç–æ-–æ—Ç–≤–µ—Ç—ã –ø–æ —É—Å–ª–æ–≤–∏—è–º
**–û–ø–∞—Å–Ω—ã–µ –ø–∏—Å—å–º–∞**: –≤—Å–µ–≥–¥–∞ –∫–∞—Ä–∞–Ω—Ç–∏–Ω, –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤

### "–ì–¥–µ —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è?"

**3 –º–µ—Å—Ç–∞:**
1. **Dashboard** (`/mailguard/`) ‚Üí "Security Overview" –∫–∞—Ä—Ç–∞
2. **–°–ø–∏—Å–æ–∫ –ø–∏—Å–µ–º** ‚Üí Badges —Ä—è–¥–æ–º —Å —Ç–µ–º–æ–π:
   - ‚úÖ –ó–µ–ª—ë–Ω—ã–π = –±–µ–∑–æ–ø–∞—Å–Ω–æ
   - ‚ö†Ô∏è –ñ—ë–ª—Ç—ã–π = –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ
   - üö® –ö—Ä–∞—Å–Ω—ã–π = –æ–ø–∞—Å–Ω–æ
3. **–î–µ—Ç–∞–ª–∏ –ø–∏—Å—å–º–∞** ‚Üí –°–µ–∫—Ü–∏—è "Sicherheitspr√ºfung":
   - Risk score (0-100)
   - VirusTotal —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —É–≥—Ä–æ–∑—ã
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

## üîë –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**API Endpoints:**
- Email Scanner: `https://vat-bot-1.onrender.com/file-scanner/api/email-scan`
- MailGuard Dashboard: `https://vat-bot-1.onrender.com/mailguard/`

**API Keys (Production –Ω–∞ Render):**
- VirusTotal: `7977663b17d01aade4620f45d557de21525b7a67e91e21986ac2fb5f85574e66`
- FILE_SCANNER_URL: `https://vat-bot-1.onrender.com/file-scanner/api/email-scan`
- FILE_SCANNER_ENABLED: `true`

**Database Models:**
- `MailAccount` - email accounts —Å encrypted passwords
- `MailMessage` - messages —Å thread_id, in_reply_to, references
- `MailRule` - processing rules —Å priorities
- `MailDraft` - AI-generated replies
- `KnownCounterparty` - CRM integration —Å trust_level

**Connectors:**
- `app/mailguard/connectors/imap.py` - fetch_new_imap()
- `app/mailguard/connectors/smtp.py` - send_smtp_email()
- `app/mailguard/scanner_client.py` - scan_message()

---

## üí° –ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç:**
- "–ø—Ä–æ–≤–µ—Ä–∏—Ç—å email –Ω–∞ –≤–∏—Ä—É—Å—ã"
- "—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ—á—Ç—É"
- "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å email"
- "–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è"
- "—Ñ–∏—à–∏–Ω–≥ –≤ –ø–∏—Å—å–º–∞—Ö"
- "MailGuard —á—Ç–æ —ç—Ç–æ"

**‚Üí –ù–∞–ø—Ä–∞–≤–ª—è–π –Ω–∞ MailGuard** (`/mailguard/`)

**–ï—Å–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç:**
- "–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ –≤–∏—Ä—É—Å—ã"
- "—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç"
- "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞"

**‚Üí –ù–∞–ø—Ä–∞–≤–ª—è–π –Ω–∞ File Scanner** (`/file-scanner/`)

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ AI Assistant

1. **‚ùå "–£ –Ω–∞—Å –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ email"** ‚Üí ‚úÖ "–ï—Å—Ç—å! MailGuard —Å VirusTotal"
2. **‚ùå "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å"** ‚Üí ‚úÖ "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞—à –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π MailGuard"
3. **‚ùå "MailGuard - —ç—Ç–æ –≤–Ω–µ—à–Ω–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç"** ‚Üí ‚úÖ "MailGuard - —á–∞—Å—Ç—å –Ω–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"
4. **‚ùå "OAuth —Ç—Ä–µ–±—É–µ—Ç—Å—è"** ‚Üí ‚úÖ "IMAP/SMTP —Å App-Password (–¥–ª—è Gmail/Outlook)"
5. **‚ùå "–†—É—á–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"** ‚Üí ‚úÖ "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ö–ê–ñ–î–û–ì–û –ø–∏—Å—å–º–∞"

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API**: `/file_scanner/EMAIL_SCAN_API.md`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã**: `/file_scanner/ARCHITECTURE.md`
- **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ**: `/file_scanner/README.md`
- **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–∞**: `/AGENT_SYSTEM_PROMPT.md`

---

**Last Updated:** November 11, 2025  
**Status:** ‚úÖ Production-ready –Ω–∞ Render  
**VirusTotal API:** –ê–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
