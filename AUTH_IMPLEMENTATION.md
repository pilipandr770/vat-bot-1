# –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –°–∏—Å—Ç–µ–º–∏ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó - –ó–∞–≤–µ—Ä—à–µ–Ω–æ! ‚úÖ

## üì¶ –°—Ç–≤–æ—Ä–µ–Ω—ñ –§–∞–π–ª–∏

### Auth Module
1. **auth/routes.py** (318 —Ä—è–¥–∫—ñ–≤)
   - `/register` - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   - `/login` - –í—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
   - `/logout` - –í–∏—Ö—ñ–¥
   - `/confirm/<token>` - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
   - `/resend-confirmation` - –ü–æ–≤—Ç–æ—Ä–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ email
   - `/reset-password-request` - –ó–∞–ø–∏—Ç –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
   - `/reset-password/<token>` - –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ —Ç–æ–∫–µ–Ω–æ–º
   - `/profile` - –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   
   **–§—É–Ω–∫—Ü—ñ—ó:**
   - `send_confirmation_email()` - –í—ñ–¥–ø—Ä–∞–≤–∫–∞ email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
   - `send_password_reset_email()` - –í—ñ–¥–ø—Ä–∞–≤–∫–∞ email –¥–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
   - `generate_reset_token()` - –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—É —Å–∫–∏–¥–∞–Ω–Ω—è
   - `verify_reset_token()` - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–∫–µ–Ω—É

### Templates (–ù—ñ–º–µ—Ü—å–∫–æ—é)
2. **templates/auth/register.html** - –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é
3. **templates/auth/login.html** - –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É –∑ "Remember Me"
4. **templates/auth/reset_password_request.html** - –ó–∞–ø–∏—Ç –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
5. **templates/auth/reset_password.html** - –§–æ—Ä–º–∞ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
6. **templates/auth/profile.html** - –°—Ç–æ—Ä—ñ–Ω–∫–∞ –ø—Ä–æ—Ñ—ñ–ª—é –∑ sidebar navigation

### –û–Ω–æ–≤–ª–µ–Ω—ñ –§–∞–π–ª–∏
7. **auth/models.py**
   - –î–æ–¥–∞–Ω–æ –ø–æ–ª—è: `password_reset_token`, `password_reset_expires`
   
8. **app.py**
   - –î–æ–¥–∞–Ω–æ Flask-Login integration
   - –î–æ–¥–∞–Ω–æ Flask-Mail integration
   - –ó–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ auth blueprint
   - –û–Ω–æ–≤–ª–µ–Ω–æ routes:
     * `/` ‚Üí `landing()` - –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö
     * `/dashboard` ‚Üí –≥–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö
   - –î–æ–¥–∞–Ω–æ `@login_required` –¥–æ `/verify`
   - –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –∫–≤–æ—Ç–∏ API
   - –î–æ–¥–∞–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è `user_id` —É verification check

9. **templates/base.html**
   - –î–∏–Ω–∞–º—ñ—á–Ω–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö/–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö
   - Dropdown –º–µ–Ω—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   - –ü–æ–∫–∞–∑ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   
10. **config.py**
    - –î–æ–¥–∞–Ω–æ Flask-Mail –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    - –î–æ–¥–∞–Ω–æ Stripe –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é

11. **notifications/alerts.py**
    - –î–æ–¥–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é `send_email()` –¥–ª—è Flask-Mail

---

## üé® UI/UX –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

### –î–∏–∑–∞–π–Ω —à–∞–±–ª–æ–Ω—ñ–≤:
- **Register**: –ü–æ–≤–Ω–∞ —Ñ–æ—Ä–º–∞ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –¥–∞–Ω–∏—Ö, checkbox AGB, —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–≤–∞–≥ Free –ø–ª–∞–Ω—É
- **Login**: –ú—ñ–Ω—ñ–º–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π –¥–∏–∑–∞–π–Ω, "Remember Me", –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ reset password
- **Profile**: Sidebar navigation + —Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∑ Account Info —Å–µ–∫—Ü—ñ—î—é

### –ù—ñ–º–µ—Ü—å–∫—ñ —Ç–µ–∫—Å—Ç–∏:
- –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏
- –ü—ñ–¥–ø–∏—Å–∏ –∫–Ω–æ–ø–æ–∫
- Flash messages
- Email —à–∞–±–ª–æ–Ω–∏

---

## üîê –ë–µ–∑–ø–µ–∫–∞

1. **Password Hashing**: Werkzeug PBKDF2-SHA256
2. **Email Verification**: –û–±–æ–≤'—è–∑–∫–æ–≤–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
3. **Password Reset**: 24-–≥–æ–¥–∏–Ω–Ω–∏–π —Ç–æ–∫–µ–Ω
4. **Session Management**: Flask-Login –∑ "Remember Me"
5. **CSRF Protection**: Flask-WTF forms
6. **SQL Injection**: SQLAlchemy ORM
7. **Rate Limiting**: –ì–æ—Ç–æ–≤–æ –¥–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è

---

## üìß Email –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### –®–∞–±–ª–æ–Ω–∏ Email (–Ω—ñ–º–µ—Ü—å–∫–æ—é):
1. **Confirmation Email**:
   - –ü—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   - –ö–Ω–æ–ø–∫–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
   - Fallback —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

2. **Password Reset Email**:
   - –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑—ñ —Å–∫–∏–¥–∞–Ω–Ω—è
   - 24-–≥–æ–¥–∏–Ω–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è
   - –ö–Ω–æ–ø–∫–∞ reset password

---

## üöÄ Workflow –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è:
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–ø–æ–≤–Ω—é—î —Ñ–æ—Ä–º—É —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
2. –°–∏—Å—Ç–µ–º–∞ —Å—Ç–≤–æ—Ä—é—î User + Free Subscription (5 checks/month)
3. –í—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è confirmation email
4. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î email —á–µ—Ä–µ–∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è
5. –ú–æ–∂–µ —É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É

### –í—Ö—ñ–¥:
1. Email + Password
2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: is_active, is_email_confirmed
3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è last_login timestamp
4. Redirect –Ω–∞ Dashboard

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞:
1. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞ Dashboard
2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–≤–æ—Ç–∏: `can_perform_verification()`
3. –í–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
4. –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç `api_calls_used`
5. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –∑ `user_id`

---

## üìä –ë–∞–∑–∞ –î–∞–Ω–∏—Ö

### –ù–æ–≤—ñ –ø–æ–ª—è User:
```python
password_reset_token: String(100)  # Token –¥–ª—è reset
password_reset_expires: DateTime   # Expiry 24h
```

### VerificationCheck:
```python
user_id: Integer  # FK –¥–æ users.id
```

---

## üîß –ù–∞—Å—Ç—É–ø–Ω—ñ –ö—Ä–æ–∫–∏

### –î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```bash
# 1. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install Flask-Login Flask-Mail

# 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –ë–î
flask db migrate -m "Add user authentication tables"
flask db upgrade

# 3. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ .env
MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password
MAIL_DEFAULT_SENDER=noreply@vatverification.com

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
python app.py

# 5. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –ø–µ—Ä—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
# –í—ñ–¥–∫—Ä–∏—Ç–∏: http://127.0.0.1:5000/auth/register
```

### –ì–æ—Ç–æ–≤–æ –¥–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó:
- ‚úÖ Stripe payments (Task #5)
- ‚úÖ Admin Dashboard (Task #6)
- ‚úÖ User Dashboard —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è (Task #7)

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**Task #2 ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û!**

–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ–≤–Ω—ñ—Å—Ç—é —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –∑:
- –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—î—é —ñ –≤—Ö–æ–¥–æ–º
- Email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è–º
- –°–∫–∏–¥–∞–Ω–Ω—è–º –ø–∞—Ä–æ–ª—è
- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è–º –ø—Ä–æ—Ñ—ñ–ª–µ–º
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é –∑ –ø—ñ–¥–ø–∏—Å–∫–∞–º–∏
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –∫–≤–æ—Ç API
- –ù—ñ–º–µ—Ü—å–∫–æ—é –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—î—é

**–ì–æ—Ç–æ–≤–æ –¥–æ –∫–æ–º–º—ñ—Ç—É —ñ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è!** üöÄ
