<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% if current_category %}
    <title>{{ category_labels.get(current_category, current_category) }} — Blog | VAT Verifizierung</title>
    <meta name="description" content="Aktuelle Artikel zu {{ category_labels.get(current_category, current_category) }}: B2B-Compliance, Betrugsschutz und sichere Geschäftspartner-Prüfung in Deutschland.">
    {% else %}
    <title>Blog — B2B-Sicherheit & Compliance | VAT Verifizierung</title>
    <meta name="description" content="Expertenwissen zu VAT-Compliance, Sanktionsprüfung, Betrugsschutz und sicherer Geschäftspartner-Verifizierung in Deutschland und der EU.">
    {% endif %}
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://vat-verifizierung.de/blog/{% if current_category %}?category={{ current_category }}{% endif %}">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Blog — B2B-Sicherheit & Compliance | VAT Verifizierung">
    <meta property="og:url" content="https://vat-verifizierung.de/blog/">
    <meta property="og:image" content="https://vat-verifizierung.de/static/images/og-image.png">

    <!-- Schema.org CollectionPage -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "VAT Verifizierung Blog",
        "description": "Expertenwissen zu B2B-Compliance und sicherer Geschäftspartner-Prüfung",
        "url": "https://vat-verifizierung.de/blog/",
        "publisher": {"@type": "Organization", "name": "VAT Verifizierung", "url": "https://vat-verifizierung.de"}
    }
    </script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">

    <style>
        .blog-hero { background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%); }
        .blog-card { transition: transform .2s, box-shadow .2s; border: none; }
        .blog-card:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,.12); }
        .category-badge { font-size: .72rem; }
        .sidebar-card { border-left: 3px solid #0d6efd; }
        .pagination-wrapper .page-link { color: #0d6efd; }
        .tag-pill { font-size: .7rem; background: #e8f0fe; color: #1967d2; border-radius: 20px; padding: 2px 8px; }
        .read-time { font-size: .78rem; color: #6c757d; }
    </style>
</head>
<body>

<!-- ── Navbar ── -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" href="/">
            <i class="bi bi-shield-check text-primary"></i> VAT Verifizierung
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navBlog">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navBlog">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="/">Start</a></li>
                <li class="nav-item"><a class="nav-link" href="/#pricing">Preise</a></li>
                <li class="nav-item"><a class="nav-link active fw-semibold" href="/blog/">Blog</a></li>
                <li class="nav-item"><a class="btn btn-primary btn-sm ms-2" href="/auth/register">Kostenlos testen</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- ── Hero ── -->
<section class="blog-hero text-white py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                {% if current_category %}
                <h1 class="display-6 fw-bold mb-2">
                    <i class="bi bi-folder2-open me-2"></i>{{ category_labels.get(current_category, current_category) }}
                </h1>
                <p class="lead mb-0 opacity-75">Aktuelle Artikel zu diesem Thema</p>
                {% else %}
                <h1 class="display-6 fw-bold mb-2">
                    <i class="bi bi-journal-richtext me-2"></i>B2B-Sicherheit &amp; Compliance Blog
                </h1>
                <p class="lead mb-0 opacity-75">
                    Expertenwissen zu VAT-Verifizierung, Sanktionsprüfung &amp; Betrugsschutz — täglich aktualisiert.
                </p>
                {% endif %}
            </div>
            <div class="col-lg-4 text-lg-end mt-3 mt-lg-0">
                <a href="/auth/register" class="btn btn-light btn-lg fw-semibold">
                    <i class="bi bi-rocket me-1"></i>Kostenlos starten
                </a>
            </div>
        </div>
    </div>
</section>

<!-- ── Main Content ── -->
<div class="container py-5">
    <div class="row g-4">

        <!-- Posts Grid -->
        <div class="col-lg-8">

            {% if posts %}
            <div class="row g-4">
                {% for post in posts %}
                <div class="col-md-6">
                    <div class="card blog-card h-100 shadow-sm">
                        <div class="card-body d-flex flex-column">
                            <!-- Category badge -->
                            <div class="mb-2">
                                <a href="/blog/?category={{ post.category }}"
                                   class="badge bg-primary text-decoration-none category-badge">
                                    {{ category_labels.get(post.category, post.category or 'Allgemein') }}
                                </a>
                            </div>
                            <!-- Title -->
                            <h2 class="h5 card-title mb-2">
                                <a href="/blog/{{ post.slug }}" class="text-dark text-decoration-none stretched-link">
                                    {{ post.title }}
                                </a>
                            </h2>
                            <!-- Meta description -->
                            {% if post.meta_description %}
                            <p class="card-text text-muted small flex-grow-1">{{ post.meta_description }}</p>
                            {% endif %}
                            <!-- Footer -->
                            <div class="mt-auto pt-2 d-flex justify-content-between align-items-center border-top">
                                <span class="read-time">
                                    <i class="bi bi-clock me-1"></i>{{ post.read_time_minutes or 3 }} Min. Lesezeit
                                </span>
                                <span class="read-time">
                                    <i class="bi bi-calendar3 me-1"></i>{{ post.published_at.strftime('%d.%m.%Y') if post.published_at else '' }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Pagination -->
            {% if pagination.pages > 1 %}
            <nav class="mt-5 pagination-wrapper" aria-label="Blog-Seitennavigation">
                <ul class="pagination justify-content-center">
                    {% if pagination.has_prev %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ pagination.prev_num }}{% if current_category %}&category={{ current_category }}{% endif %}">
                            <i class="bi bi-chevron-left"></i>
                        </a>
                    </li>
                    {% endif %}
                    {% for p in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
                        {% if p %}
                        <li class="page-item {% if p == pagination.page %}active{% endif %}">
                            <a class="page-link" href="?page={{ p }}{% if current_category %}&category={{ current_category }}{% endif %}">{{ p }}</a>
                        </li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">…</span></li>
                        {% endif %}
                    {% endfor %}
                    {% if pagination.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ pagination.next_num }}{% if current_category %}&category={{ current_category }}{% endif %}">
                            <i class="bi bi-chevron-right"></i>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </nav>
            {% endif %}

            {% else %}
            <div class="text-center py-5">
                <i class="bi bi-journal-x display-1 text-muted"></i>
                <h3 class="mt-3 text-muted">Noch keine Artikel veröffentlicht</h3>
                <p class="text-muted">Der erste Artikel erscheint in Kürze — täglich neu!</p>
                <a href="/blog/" class="btn btn-primary mt-2">Alle Kategorien anzeigen</a>
            </div>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">

            <!-- CTA Box -->
            <div class="card bg-primary text-white mb-4 border-0">
                <div class="card-body p-4">
                    <h5 class="fw-bold"><i class="bi bi-shield-check me-2"></i>Geschäftspartner prüfen</h5>
                    <p class="small mb-3">VAT, Sanktionen, OSINT und mehr — automatisiert in Sekunden.</p>
                    <a href="/auth/register" class="btn btn-light btn-sm fw-semibold w-100">
                        Kostenlos testen <i class="bi bi-arrow-right ms-1"></i>
                    </a>
                </div>
            </div>

            <!-- Categories -->
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-header bg-white fw-semibold border-bottom">
                    <i class="bi bi-tags me-2 text-primary"></i>Kategorien
                </div>
                <div class="card-body p-0">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item {% if not current_category %}fw-semibold{% endif %}">
                            <a href="/blog/" class="text-decoration-none text-dark d-flex justify-content-between">
                                <span><i class="bi bi-grid-3x3-gap me-2 text-muted"></i>Alle Artikel</span>
                                <span class="badge bg-light text-dark">{{ category_counts.values()|sum }}</span>
                            </a>
                        </li>
                        {% for cat_id, label in category_labels.items() %}
                        {% if category_counts.get(cat_id) %}
                        <li class="list-group-item {% if current_category == cat_id %}fw-semibold bg-light{% endif %}">
                            <a href="/blog/?category={{ cat_id }}" class="text-decoration-none text-dark d-flex justify-content-between">
                                <span>{{ label }}</span>
                                <span class="badge bg-primary">{{ category_counts.get(cat_id, 0) }}</span>
                            </a>
                        </li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <!-- Features teaser -->
            <div class="card border-0 shadow-sm sidebar-card">
                <div class="card-body p-4">
                    <h6 class="fw-bold mb-3">Was bietet VAT Verifizierung?</h6>
                    <ul class="list-unstyled small">
                        <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>VIES VAT-Validierung</li>
                        <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>EU/OFAC/UK Sanktionsprüfung</li>
                        <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>OSINT & Website-Scanner</li>
                        <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>Phone Intelligence</li>
                        <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>E-Mail-Sicherheit (MailGuard)</li>
                        <li><i class="bi bi-check-circle-fill text-success me-2"></i>API-Zugang für Entwickler</li>
                    </ul>
                    <a href="/#features" class="btn btn-outline-primary btn-sm w-100 mt-2">Alle Features →</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ── Footer ── -->
<footer class="bg-dark text-white py-4 mt-5">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <p class="mb-0">&copy; {{ current_date.year if current_date else 2026 }} VAT Verifizierung. Alle Rechte vorbehalten.</p>
            </div>
            <div class="col-md-6 text-md-end">
                <a href="/legal/agb" class="text-white me-3">AGB</a>
                <a href="/legal/datenschutz" class="text-white me-3">Datenschutz</a>
                <a href="/legal/impressum" class="text-white">Impressum</a>
            </div>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
